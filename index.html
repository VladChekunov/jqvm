<!DOCTYPE html>
<html>
  <head>
    <style>
      section {
        margin-bottom: 40px;
      }
      .app {
        border-bottom: #f1f1f1 solid 1px;
        margin-bottom: 40px;
      }
    </style>
  </head>
  <body>
    <template id="app" attrs="{ class: 'app', style: 'color: #666' }">
      <section>
        <div jq-if="show">shown</div>
        <div jq-if="!show">hidden</div>
        <button class="toggle">toggle</button>
      </section>

      <section>
        <div>{{title}}</div>
        <div><input jq-value="title" data-title-input></div>
      </section>

      <section>
        <div><pre>{{text}}</pre></div>
        <div><textarea jq-value="text" data-text-input></textarea></div>
      </section>

      <section>
        <div>
          <label>
            <input type="checkbox" jq-checked="checked" data-checkbox>
            Item1 {{checked}}
          </label>
        </div>
        <div>
          select: {{radio}}
          <label>
            <input type="radio" jq-checked="radio === 'a'" value="a" data-radio name="radio">
            A
          </label>
          <label>
            <input type="radio" jq-checked="radio === 'b'" value="b" data-radio name="radio">
            B
          </label>
        </div>
        <div>
          select: {{select}}
          <select jq-value="select" data-select>
            <option jq-repeat="item in items traceby item.name" value="{{item.name}}">{{item.name}}</option>
          </select>
        </div>
        <div>
          range: {{range}}
          <input type="range" jq-value="range" data-range />
          <input type="text" jq-value="range" readonly />
        </div>
      </section>

      <section>
        <div jq-repeat="item,index in items traceby item.name">{{item.name}}</div>
      </section>

      <section>
        <football color="#dd2311"></football>
      </section>

      <section>
        <div jq-hash="keep">
          {{keep}}
          <button data-change-by-hash>change keep</button>
        </div>
      </section>
    </template>

    <div id="model"></div>

    <script src="https://unpkg.com/jquery/dist/jquery.min.js"></script>
    <script src="https://unpkg.com/tyshemo/dist/tyshemo.min.js"></script>
    <script src="dist/jqvm.js"></script>

    <script>
      $.vm.component('football', function($el, attrs) {
        const { color } = attrs
        return `<span style="color:${color}">football</span>`
      })

      $('#app')
        .vm({
          show: true,
          title: 'This is title text!',
          text: 'This is a long text, \nwhich has break wrodk',
          checked: false,
          radio: 'a',
          select: 'ccc',
          items: [
            { name: 'aaa' },
            { name: 'bbb' },
            { name: 'ccc' },
          ],
          keep: 0,
          range: 0,
        })
        .on('click', '.toggle', vm => vm.show = !vm.show)
        .on('input', '[data-title-input]', vm => function(e) {
          const value = e.target.value
          vm.title = value
        })
        .on('input', '[data-text-input]', vm => function(e) {
          const value = e.target.value
          vm.text = value
        })
        .on('change', '[data-checkbox]', vm => {
          vm.checked = !vm.checked
        })
        .on('change', '[name=radio]', vm => function(e) {
          const value = e.target.value
          vm.radio = value
        })
        .on('change', '[data-select]', vm => function(e) {
          const value = e.target.value
          vm.select = value
        })
        .on('input', '[data-range]', vm => function(e) {
          const value = e.target.value
          vm.range = value
        })
        .on('click', '[data-change-by-hash]', vm => {
          vm.keep ++
        })
        .mount()

      const { Model, Meta } = window.tyshemo
      class Person extends Model {
        static name = new Meta({
          default: '',
        })
        static age = new Meta({
          default: 0,
        })
      }

      const template = `
        <template>
          <div class="name">{{name}}</div>
          <div class="age">{{age}}</div>
          <button data-grow>Grow</button>
          <button data-destroy>Destroy</button>
        </template>
      `
      $(template)
        .vm(new Person())
        .on('$mount', vm => () => {
          vm.name = 'timy'
          vm.age = 12
        })
        .on('click', '[data-grow]', vm => () => {
          vm.age ++
        })
        .on('click', '[data-destroy]', function() {
          this.unmount()
        })
        .mount('#model')
    </script>
  </body>
</html>
